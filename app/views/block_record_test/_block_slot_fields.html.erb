<div class="nested-fields project-tag-fields">
  <%= f.association :block_kind, collection: BlockKind.all %>

  <% if f.object.try(:block_kind) %>
    <% klass = f.object.block_kind.name.constantize %>
    <%= f.simple_fields_for :block do |f| %>
      <%= render "blocks/#{klass.model_name.singular}/edit", f: f %>
    <% end %>

    <%= link_to_add_association 'add block',
                                f,
                                :block,
                                partial: "blocks/#{klass.model_name.singular}/edit",
                                class: 'btn btn-primary'  %>
  <% end %>

  <%= f.input :layout %>
  <%= f.input :block_record_type %>
  <%= f.input :position %>

  <%= link_to_remove_association 'remove block slot', f, class: 'btn btn-default' %>
</div>
