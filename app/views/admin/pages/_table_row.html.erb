<%= content_tag :tr, class: "level-#{level} #{'table__row--child' if level > 0}" do %>
  <% if Page.statusable? %>
    <td><%= status_indicator page %></td>
  <% end %>
  <td><%= page.id %></td>
  <td><%= admin_page_level_indicator level %><%= page.title %></td>
  <td><%= link_to(page.path, page_path(page)) %></td>
  <td><%= page.updated_at.to_formatted_s(:short) %></td>
  <td width="1"><%= link_to 'Edit', edit_admin_page_path(page), class: 'btn btn-xs btn-primary', role: 'button' %></td>
  <td width="1"><%= link_to 'Show', page_path(page), class: 'btn btn-xs btn-info', role: 'button' %></td>
  <td width="1"><%= link_to 'Destroy', [:admin, page], method: :delete, class: 'btn btn-xs btn-danger', role: 'button', data: { confirm: 'Are you sure you want to destroy this record? This action is irreversible.' } %></td>
<% end %>

<%# TODO: fix page caching %>
<%= render partial: 'table_row', collection: page.immediate_children, locals: { level: level + 1 }, as: :page %>
