<%= simple_form_for([:admin, @page]) do |f| %>
  <%= f.error_notification %>

  <div class="row">
    <div class="col-sm-12">

      <% if @page.redirect.present? %>
        <div class="alert alert-danger" role="alert">
          <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
          <span class="sr-only">Error:</span>
          This page is being redirected to: <%= link_to @page.redirect, @page.redirect, class: 'text-danger' %>
        </div>
      <% end %>

      <div class="panel panel-default" data-collapse-parent>
        <div class="panel-heading">
          <h3 class="panel-title">
            Metadata
            <button type="button" class="btn btn-default btn-xs pull-right" data-collapse-trigger>
              <div class="collapsable-icon glyphicon glyphicon-chevron-up"></div>
            </button>
          </h3>
        </div>
        <div class="panel-body" data-collapse-body>
          <% if I18n.available_locales.length > 1 %>
            <ul class="nav nav-tabs">
              <% I18n.available_locales.collect(&:to_s).each_with_index do |locale, index| %>
                <% active_class = 'active' if index.zero? %>
                <%= content_tag :li, class: active_class do %>
                  <%= link_to locale.to_s.upcase, "#page-metadata-#{locale.to_s}", data: { toggle: 'tab' } %>
                <% end %>
              <% end %>
            </ul>
            <br>
          <% end %>

          <div class="form-inputs tab-content">
            <% I18n.available_locales.collect(&:to_s).each_with_index do |locale, index| %>
              <%= content_tag :div, id: "page-metadata-#{locale.to_s}", class: "row tab-pane #{'active' if index.zero?}" do %>
                <div class="col-sm-6">
                  <%= localized_input f, :title, locale %>
                  <% if index.zero? %>
                    <%= render 'admin/form_inputs/slug', f: f %>
                    <%= f.association :parent_page, remote: { scope: :title_like, path: admin_pages_path(current_record: @page) } %>
                  <% end %>
                  <%= localized_input f, :seo_title, locale, label: 'SEO Title', placeholder: 'Leave blank to use the page\'s title.' %>
                  <%= localized_input f, :description, locale, label: 'SEO Description' %>
                  <%= f.button :submit, class: 'btn-success' %>
                </div>
                <div class="col-sm-6">
                  <% if index.zero? %>
                    <%= render 'admin/form_inputs/status', f: f, record: @page %>
                    <%= f.input :redirect, hint: 'Add a relative path or full URL if you need to redirect this page to another URL.' %>
                    <%= f.association :featured_image, as: :image %>
                  <% end %>
                </div>
              <% end %>
            <% end %>
          </div>
        </div>
      </div>

      <%= render 'admin/pages/additional_inputs', f: f %>

      <%= render 'admin/block_record/block_layout', f: f, block_layout: @block_layout, block_kinds: @block_kinds %>

      <%= f.button :submit, class: 'btn-success' %>
    </div>
  </div>
<% end %>
