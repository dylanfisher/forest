<% cache ['modal', MediaItem.cache_key], expires_in: 4.weeks do %>
  <div class="modal fade media-item-chooser" id="media-item-chooser" tabindex="-1" role="dialog" aria-labelledby="mediaItemChooser">
    <div class="modal-dialog modal-fluid" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="media-item-chooser__modal-title modal-title" id="gridSystemModalLabel">
            Media Library
            <div id="media-item-chooser__modal-title__loading-indicator" class="media-item-chooser__modal-title__loading-indicator text-muted small"></div>
          </h4>
          <div class="row">
            <div class="col-sm-12">
              <div class="text-muted">
                <span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span>
                Drag and drop images or files to upload new items.
              </div>
              <br>
            </div>
            <div class="col-sm-10">
              <div class="row">
                <div class="col-sm-4">
                  <%= form_tag admin_media_items_path, class: 'media-item-chooser__modal-search-form', method: :get, enforce_utf8: false do %>
                    <%= text_field_tag :fuzzy_search, params[:fuzzy_search], id: 'media_item_modal_fuzzy_search', class: 'media-item-chooser__modal-search-input form-control', placeholder: 'Search' %>
                  <% end %>
                </div>
                <div class="col-sm-4">
                  <%= dropdown_select_form url: admin_media_items_path,
                                           id: 'by_date',
                                           select_options: MediaItem.dates_for_filter,
                                           title: 'All Dates',
                                           remote_parent: '.modal',
                                           remote_target: '.modal-body',
                                           remote_response_target: '.media-library' %>
                </div>
                <div class="col-sm-4">
                  <%= dropdown_select_form url: admin_media_items_path,
                                           id: 'by_content_type',
                                           select_options: MediaItem.content_types_for_filter,
                                           title: 'All Content Types',
                                           remote_parent: '.modal',
                                           remote_target: '.modal-body',
                                           remote_response_target: '.media-library' %>
                </div>
              </div>
            </div>
            <div class="col-sm-2 text-right">
              <button type="button" class="media-item-chooser__select-button btn btn-primary">Select</button>
            </div>
          </div>
        </div>
        <%= render 'admin/file_upload', klass: MediaItem, association: :attachment %>
        <div class="modal-body">
          Loading...
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          <button type="button" class="media-item-chooser__select-button btn btn-primary">Select</button>
        </div>
      </div>
    </div>
  </div>
<% end %>
